{% extends "base.html" %}
{% load static %}
{% block content %}

<!-- Titlebar
================================================== -->
<div class="single-page-header" data-background-image="{% static '' %}images/single-job.jpg">
	<div class="container">
		<div class="row" id="company_info_title">
			<div class="col-md-12">
				<div class="single-page-header-inner">
					<div class="left-side">
						<div class="header-image"><a href="single-company-profile.html"><img
									src="{{ company.logo.url }}" alt=""></a></div>
						<div class="header-details">
							<h3>{{ job.name }}</h3>
							<h5>{{ job.job_type }}</h5>
							<ul>
								<li><a href="single-company-profile.html"><i class="icon-material-outline-business"></i>
										{{ company.company_name }}</a></li>
								<li>
									<div class="star-rating" data-rating="4.9"></div>
								</li>
								<li>
									<div class="verified-badge-with-title">Verified</div>
								</li>
							</ul>
						</div>
					</div>
					<div class="right-side">
						<div class="salary-box">
							<div class="salary-type">Annual Salary</div>
							<div class="salary-amount">&#2547; {{ job.salary|stringformat:".0f" }} - &#2547; {{ job.salary2|stringformat:".0f" }}</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<!-- Page Content
================================================== -->
<div class="container">
	<div class="row">

		<!-- Content -->
		<div class="col-xl-8 col-lg-8 content-right-offset">

			<div class="single-page-section">
				<h3 class="margin-bottom-25">Job Description</h3>
				<p>
					{{ job.job_description }}
				</p>
			</div>

			<div class="single-page-section">
				<h3 class="margin-bottom-30">Skills</h3>
				<div id="single-job-map-container">
					{{ job.skills }}
				</div>
			</div>

			<div class="single-page-section">
				<h3 class="margin-bottom-30">Contact Email</h3>
				<div id="single-job-map-container">
					{{ job.contact_email }}
				</div>
			</div>

			<div class="single-page-section">
				<h3 class="margin-bottom-30">Contact Number</h3>
				<div id="single-job-map-container">
					{{ job.contact_number }}
				</div>
			</div>

			<div class="single-page-section">
				<h3 class="margin-bottom-25">Similar Jobs</h3>

				<!-- Listings Container -->
				<div class="listings-container grid-layout">
					{% for job in similar_jobs %}
					<!-- Job Listing -->
					<a href="{% url 'JobDetailView' id=job.id %}" class="job-listing">

						<!-- Job Listing Details -->
						<div class="job-listing-details">
							<!-- Logo -->
							<div class="job-listing-company-logo">
								<img src="{{ job.company_name.logo.url }}" alt="{{ job.company_name.company_name }}">
							</div>

							<!-- Details -->
							<div class="job-listing-description">
								<h4 class="job-listing-company">
									{% if job.company_name is not None %}
									{{ job.company_name.company_name }}
									{% else %}
									{{ job.designation }}
									{% endif %}
								</h4>
								<span class="verified-badge" title="Verified Employer"
									data-tippy-placement="top"></span></h4>
								<h3 class="job-listing-title">{{ job.name }}</h3>
							</div>
						</div>

						<!-- Job Listing Footer -->
						<div class="job-listing-footer">
							<ul>
								<li><i class="icon-material-outline-location-on"></i> {{ job.place }}</li>
								<li><i class="icon-material-outline-business-center"></i> {{ job.job_type }}</li>
								<li><i class="icon-material-outline-account-balance-wallet"></i> &#2547; {{ job.salary|stringformat:".0f" }} - {{ job.salary2|stringformat:".0f" }}</li>
								<li><i class="icon-material-outline-access-time"></i> {{ job.created_at|timesince }} ago
								</li>
							</ul>
						</div>
					</a>
					{% endfor %}
				</div>
				<!-- Listings Container / End -->

			</div>
		</div>


		<!-- Sidebar -->
		<div class="col-xl-4 col-lg-4">
			<div class="sidebar-container">

				{% if applied_job %}
				<!-- disabled button with applied value -->
				<a href="" class="apply-now-button popup-with-zoom-anim"
					data-toggle="tooltip" data-placement="top" title="Applied" disabled>
					<i class="icon-material-outline-check-circle"></i> Applied
				</a>
				{% else %}
				<a href="#small-dialog" class="apply-now-button popup-with-zoom-anim" id="apply_now">Apply Now <i
						class="icon-material-outline-arrow-right-alt"></i></a>
				{% endif %}

				<!-- Sidebar Widget -->
				<div class="sidebar-widget">
					<div class="job-overview">
						<div class="job-overview-headline">Job Summary</div>
						<div class="job-overview-inner">
							<ul>
								<li>
									<i class="icon-material-outline-location-on"></i>
									<span>Location</span>
									<h5>{{ job.place }}</h5>
								</li>
								<li>
									<i class="icon-material-outline-business-center"></i>
									<span>Job Type</span>
									<h5>{{ job.job_type }}</h5>
								</li>
								<li>
									<i class="icon-line-awesome-male"></i>
									<span>Vacancy</span>
									<h5>{{ job.vacancy }}</h5>
								</li>
								<li>
									<i class="icon-line-awesome-hourglass-start"></i>
									<span>Experience</span>
									<h5>{{ job.experience }} year('s)</h5>
								</li>
								<li>
									<i class="icon-material-outline-access-time"></i>
									<span>Date Posted</span>
									<h5>{{ job.created_at|timesince }} ago</h5>
								</li>
								<li>
									<i class="icon-feather-user-check"></i>
									<span>Age Limit</span>
									<h5>{{ job.minimum_age }} - {{ job.maximum_age }} years</h5>
								</li>
							</ul>
						</div>
					</div>
				</div>

				<!-- Sidebar Widget -->
				<div class="sidebar-widget">
					<h3>Bookmark or Share</h3>

					<!-- Bookmark Button -->
					<button class="bookmark-button margin-bottom-25">
						<span class="bookmark-icon"></span>
						<span class="bookmark-text">Bookmark</span>
						<span class="bookmarked-text">Bookmarked</span>
					</button>

					<!-- Copy URL -->
					<div class="copy-url">
						<input id="copy-url" type="text" value="" class="with-border">
						<button class="copy-url-button ripple-effect" data-clipboard-target="#copy-url"
							title="Copy to Clipboard" data-tippy-placement="top"><i
								class="icon-material-outline-file-copy"></i></button>
					</div>

					<!-- Share Buttons -->
					<div class="share-buttons margin-top-25">
						<div class="share-buttons-trigger"><i class="icon-feather-share-2"></i></div>
						<div class="share-buttons-content">
							<span>Interesting? <strong>Share It!</strong></span>
							<ul class="share-buttons-icons">
								<li><a href="#" data-button-color="#3b5998" title="Share on Facebook"
										data-tippy-placement="top"><i class="icon-brand-facebook-f"></i></a></li>
								<li><a href="#" data-button-color="#1da1f2" title="Share on Twitter"
										data-tippy-placement="top"><i class="icon-brand-twitter"></i></a></li>
								<li><a href="#" data-button-color="#dd4b39" title="Share on Google Plus"
										data-tippy-placement="top"><i class="icon-brand-google-plus-g"></i></a></li>
								<li><a href="#" data-button-color="#0077b5" title="Share on LinkedIn"
										data-tippy-placement="top"><i class="icon-brand-linkedin-in"></i></a></li>
							</ul>
						</div>
					</div>
				</div>

			</div>
		</div>

	</div>
</div>


<!-- Apply for a job popup
================================================== -->
<div id="small-dialog" class="zoom-anim-dialog mfp-hide dialog-with-tabs">

	<!--Tabs -->
	<div class="sign-in-form">

		<ul class="popup-tabs-nav">
			<li><a href="#tab">Apply Now</a></li>
		</ul>

		<div class="popup-tabs-container">

			<!-- Tab -->
			<div class="popup-tab-content" id="tab">

				<!-- Welcome Text -->
				<div class="welcome-text">
					<h3>Attach File With CV</h3>
				</div>

				<!-- Form -->
				<form method="POST" id="apply-now-form" enctype="multipart/form-data" action="{% url 'ApplyJobList' %}">
					{% csrf_token %}
					<div class="input-with-icon-left">
						<i class="icon-material-outline-account-circle"></i>
						<input type="text" class="input-text with-border" name="name" id="name"
							placeholder="First and Last Name" required />
					</div>

					<div class="input-with-icon-left">
						<i class="icon-material-baseline-mail-outline"></i>
						<input type="text" class="input-text with-border" name="emailaddress" id="emailaddress"
							placeholder="Email Address" required />
					</div>

					<div class="uploadButton">
						<input class="uploadButton-input" type="file" accept="image/*, application/pdf"
							id="upload-cv" name="CV_File" />
						<label class="uploadButton-button ripple-effect" for="upload-cv">Select File</label>
						<span class="uploadButton-file-name">Upload your CV / resume relevant file. <br> Max. file size:
							50 MB.</span>
					</div>

					<!-- hidden input -->
					<input type="hidden" name="job_id" id="job_id" value="{{ job.id }}">
					<input type="hidden" name="user_id" id="user_id" value="{{ user.id }}">

					<!-- Button -->
					<button class="button margin-top-35 full-width button-sliding-icon ripple-effect"
						type="submit">Apply Now <i class="icon-material-outline-arrow-right-alt"></i></button>

				</form>
			</div>

		</div>
	</div>
</div>
<!-- Apply for a job popup / End -->


<!-- Snackbar // documentation: https://www.polonel.com/snackbar/ -->
<script>
	// Snackbar for user status switcher
	$('#snackbar-user-status label').click(function () {
		Snackbar.show({
			text: 'Your status has been changed!',
			pos: 'bottom-center',
			showAction: false,
			actionText: "Dismiss",
			duration: 3000,
			textColor: '#fff',
			backgroundColor: '#383838'
		});
	});

	// Snackbar for copy to clipboard button
	$('.copy-url-button').click(function () {
		Snackbar.show({
			text: 'Copied to clipboard!',
		});

	});
	// $(document).on('submit', '#apply-now-form', function (e) {
	// 	e.preventDefault();
	// 	var element = $('#apply_now');
	// 	console.log("element is---------------> ",element);
	// 	var name = $('#name').val();
	// 	var emailaddress = $('#emailaddress').val();
	// 	var cv = $('#upload-cv').val();
	// 	var job_id = $('#job_id').val();
	// 	var user_id = $('#user_id').val();
	// 	var data = {
	// 		full_name: name,
	// 		email: emailaddress,
	// 		cv: cv,
	// 		job: job_id,
	// 		user: user_id
	// 	};
	// 	console.log("formData", data);
	// 	$.ajax({
	// 		url: '',
	// 		type: 'POST',
	// 		data: data,
	// 		headers: {
	// 			"X-CSRFToken": '{{ csrf_token }}'
	// 		},
	// 		success: function (data) {
	// 			console.log("data", data);
	// 			// Snackbar.show({
	// 			// 	text: 'Your application has been submitted successfully!',
	// 			// 	pos: 'bottom-center',
	// 			// 	showAction: false,
	// 			// 	actionText: "Dismiss",
	// 			// 	duration: 3000,
	// 			// 	textColor: '#fff',
	// 			// 	backgroundColor: '#383838'
	// 			// });

	// 		},
	// 		error: function (data) {
	// 			console.log("data", data);
	// 			// Snackbar.show({
	// 			// 	text: 'Your application cannot be submitted!',
	// 			// 	pos: 'bottom-center',
	// 			// 	showAction: false,
	// 			// 	actionText: "Dismiss",
	// 			// 	duration: 3000,
	// 			// 	textColor: '#fff',
	// 			// 	backgroundColor: '#383838'
	// 			// });
	// 		}
	// });
	// });
</script>

<!-- Google API & Maps -->
<!-- Geting an API Key: https://developers.google.com/maps/documentation/javascript/get-api-key -->
<script
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAaoOT9ioUE4SA8h-anaFyU4K63a7H-7bc&amp;libraries=places"></script>
{% endblock content %}